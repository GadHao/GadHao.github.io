---
layout: post
title: '通过Windows系统服务守护进程的运行'
date: 2021-09-13
author: HANABI
tags: [.NET]
---

> 遇到这样一个需求，需要保持一个桌面客户端程序在用户电脑上的运行，并在意外关闭或者手动关闭后也要重新启动

## 初步尝试

在平时的开发过程中，遇到需要启动进程的需求，肯定会想到使用：

```c#
System.Diagnostics.Process.Start("Example.exe");
```

这样的方式来启动一个进程，于是针对现在的需求，我们可能会在系统服务程序中写出这样的代码：

```c#
var processName = "notepad";

while (true)
{
    Thread.Sleep(5000);

    if (!(Process.GetProcessesByName("notepad")?.Length > 0))
    {
        Process.Start(processName);
    }
}
```
为了验证是否能够生效，我们安装系统服务并启动这个系统服务[^1]，可以观察到记事本程序没有按照预期启动



[^1]: 关于如何安装和启动系统服务，可以查看[Windows相关备忘的第18点](/posts/Tips-2/)